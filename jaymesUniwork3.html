<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assignments</title>
    <style>
        body {
            background: linear-gradient(45deg, darkblue, purple);
            color: yellow;
            font-family: Arial, sans-serif;
        }
        #header {
            text-align: right;
            padding: 10px;
            font-size: 1.5em;
        }
        .assignment {
            margin: 20px;
        }
        .assignment button {
            background-color: yellow;
            color: darkblue;
            padding: 10px;
            border: none;
            cursor: pointer;
            margin-right: 10px;
        }
        .hidden {
            display: none;
        }
        .pdf-container {
            margin-top: 20px;
        }
        iframe {
            width: 100%;
            height: 400px;
        }
        .pdf-link {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }
        .pdf-link a {
            color: yellow;
        }
        .storage-button {
            display: block;
            margin: 20px auto;
            padding: 10px 20px;
            background-color: yellow;
            color: darkblue;
            border: none;
            cursor: pointer;
        }
        #storagePage {
            display: none;
            background-color: grey;
            color: yellow;
            padding: 20px;
        }
        #mainPage {
            display: block;
        }
    </style>
    <script>
        const uploadPassword = "5588"; // Set the password here

        function savePdfLink(assignmentId) {
            const passwordInput = document.getElementById(`passwordInput-${assignmentId}`).value;
            if (passwordInput !== uploadPassword) {
                alert('Incorrect password. Upload denied.');
                return;
            }

            const pdfInput = document.getElementById(`pdfInput-${assignmentId}`);
            const files = pdfInput.files;
            let storedFiles = JSON.parse(localStorage.getItem(`assignment-${assignmentId}`)) || [];
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const reader = new FileReader();
                reader.onload = function(e) {
                    storedFiles.push({ name: file.name, data: e.target.result });
                    localStorage.setItem(`assignment-${assignmentId}`, JSON.stringify(storedFiles));
                    alert('PDF linked successfully!');
                    loadPdfLinks(); // Refresh the links after saving
                };
                reader.readAsDataURL(file);
            }
        }

        function loadPdfLinks() {
            const assignments = document.querySelectorAll('.assignment');
            assignments.forEach(assignment => {
                const id = assignment.dataset.id;
                const storedFiles = JSON.parse(localStorage.getItem(`assignment-${id}`)) || [];
                const linkContainer = assignment.querySelector('.link-container');
                linkContainer.innerHTML = ''; // Clear previous links
                
                storedFiles.forEach((file, index) => {
                    const pdfLinkDiv = document.createElement('div');
                    pdfLinkDiv.classList.add('pdf-link');

                    const linkElement = document.createElement('a');
                    linkElement.href = file.data;
                    linkElement.textContent = file.name;
                    linkElement.target = '_blank';
                    pdfLinkDiv.appendChild(linkElement);
                    
                    const viewButton = document.createElement('button');
                    viewButton.textContent = 'View Assignment Storage';
                    viewButton.onclick = function() {
                        viewAssignment(id);
                    };
                    pdfLinkDiv.appendChild(viewButton);

                    const deleteButton = document.createElement('button');
                    deleteButton.textContent = 'Delete';
                    deleteButton.onclick = function() {
                        deletePdfLink(id, index);
                    };
                    pdfLinkDiv.appendChild(deleteButton);

                    linkContainer.appendChild(pdfLinkDiv);
                });

                if (storedFiles.length > 0) {
                    const openPdfButton = document.createElement('button');
                    openPdfButton.textContent = 'Open Linked PDF';
                    openPdfButton.onclick = function() {
                        openPdfFile(id);
                    };
                    linkContainer.appendChild(openPdfButton);
                }
            });
        }

        function openPdfFile(assignmentId) {
            const passwordInput = document.getElementById(`passwordInput-${assignmentId}`).value;
            if (passwordInput !== uploadPassword) {
                alert('Incorrect password. Access denied.');
                return;
            }

            const storedFiles = JSON.parse(localStorage.getItem(`assignment-${assignmentId}`)) || [];
            if (storedFiles.length > 0) {
                window.open(storedFiles[0].data, '_blank');
            } else {
                alert('No PDF linked to this assignment.');
            }
        }

        function viewAssignment(id) {
            const storedFiles = JSON.parse(localStorage.getItem(`assignment-${id}`)) || [];
            const pdfContainer = document.getElementById('pdfContainer');
            pdfContainer.innerHTML = ''; // Clear previous content
            storedFiles.forEach((file, index) => {
                const pdfLinkDiv = document.createElement('div');
                pdfLinkDiv.classList.add('pdf-link');

                const linkElement = document.createElement('a');
                linkElement.href = file.data;
                linkElement.textContent = file.name;
                linkElement.target = '_blank';
                pdfLinkDiv.appendChild(linkElement);

                const deleteButton = document.createElement('button');
                deleteButton.textContent = 'Delete';
                deleteButton.onclick = function() {
                    deletePdfLink(id, index);
                };
                pdfLinkDiv.appendChild(deleteButton);

                pdfContainer.appendChild(pdfLinkDiv);
            });
            pdfContainer.dataset.id = id;
            pdfContainer.classList.remove('hidden');
        }

        function deletePdfLink(assignmentId, fileIndex) {
            let storedFiles = JSON.parse(localStorage.getItem(`assignment-${assignmentId}`)) || [];
            storedFiles.splice(fileIndex, 1);
            localStorage.setItem(`assignment-${assignmentId}`, JSON.stringify(storedFiles));
            alert('PDF link deleted successfully!');
            loadPdfLinks();
            viewAssignment(assignmentId);
        }

        function togglePasswordVisibility(assignmentId) {
            const passwordInput = document.getElementById(`passwordInput-${assignmentId}`);
            const toggleButton = document.getElementById(`togglePassword-${assignmentId}`);
            if (passwordInput.type === "password") {
                passwordInput.type = "text";
                toggleButton.textContent = "Hide";
            } else {
                passwordInput.type = "password";
                toggleButton.textContent = "Show";
            }
        }

        function submitPassword(assignmentId) {
            savePdfLink(assignmentId);
        }

        function openStoragePage() {
            document.getElementById('mainPage').style.display = 'none';
            document.getElementById('storagePage').style.display = 'block';
            loadStorage();
        }

        function loadStorage() {
            const pdfContainer = document.getElementById('storagePdfContainer');
            pdfContainer.innerHTML = ''; // Clear previous content
            for (let id = 1; id <= 5; id++) {
                const storedFiles = JSON.parse(localStorage.getItem(`assignment-${id}`)) || [];
                storedFiles.forEach((file, index) => {
                    const pdfLinkDiv = document.createElement('div');
                    pdfLinkDiv.classList.add('pdf-link');

                    const linkElement = document.createElement('a');
                    linkElement.href = file.data;
                    linkElement.textContent = `Assignment ${id}: ${file.name}`;
                    linkElement.target = '_blank';
                    pdfLinkDiv.appendChild(linkElement);

                    const deleteButton = document.createElement('button');
                    deleteButton.textContent = 'Delete';
                    deleteButton.onclick = function() {
                        deletePdfLink(id, index);
                    };
                    pdfLinkDiv.appendChild(deleteButton);

                    pdfContainer.appendChild(pdfLinkDiv);
                });
            }
        }

        function deletePdfLink(assignmentId, fileIndex) {
            let storedFiles = JSON.parse(localStorage.getItem(`assignment-${assignmentId}`)) || [];
            storedFiles.splice(fileIndex, 1);
            localStorage.setItem(`assignment-${assignmentId}`, JSON.stringify(storedFiles));
            alert('PDF link deleted successfully!');
            loadStorage();
        }

        document.addEventListener('DOMContentLoaded', loadPdfLinks);
    </script>
</head>
<body>
    <div id="header">Jaymes Cardoso Ake</div>

    <!-- Main Page -->
    <div id="mainPage">
        <h1>Assignments</h1>
        <div class="assignment" data-id="1">
            <h2>Assignment 1</h2>
            <input type="file" id="pdfInput-1" accept="application/pdf" multiple>
            <input type="password" id="passwordInput-1" placeholder="Enter password">
            <button id="togglePassword-1" onclick="togglePasswordVisibility(1)">Show</button>
            <button onclick="submitPassword(1)">Upload PDF</button>
            <div class="link-container"></div>
        </div>
        <div class="assignment" data-id="2">
            <h2>Assignment 2</h2>
            <input type="file" id="pdfInput-2" accept="application/pdf" multiple>
            <input type="password" id="passwordInput-2" placeholder="Enter password">
            <button id="togglePassword-2" onclick="togglePasswordVisibility(2)">Show</button>
            <button onclick="submitPassword(2)">Upload PDF</button>
            <div class="link-container"></div>
        </div>
        <div class="assignment" data-id="3">
            <h2>Assignment 3</h2>
            <input type="file" id="pdfInput-3" accept="application/pdf" multiple>
            <input type="password" id="passwordInput-3" placeholder="Enter password">
            <button id="togglePassword-3" onclick="togglePasswordVisibility(3)">Show</button>
            <button onclick="submitPassword(3)">Upload PDF</button>
            <div class="link-container"></div>
        </div>
        <div class="assignment" data-id="4">
            <h2>Assignment 4</h2>
            <input type="file" id="pdfInput-4" accept="application/pdf" multiple>
            <input type="password" id="passwordInput-4" placeholder="Enter password">
            <button id="togglePassword-4" onclick="togglePasswordVisibility(4)">Show</button>
            <button onclick="submitPassword(4)">Upload PDF</button>
            <div class="link-container"></div>
        </div>
        <div class="assignment" data-id="5">
            <h2>Assignment 5</h2>
            <input type="file" id="pdfInput-5" accept="application/pdf" multiple>
            <input type="password" id="passwordInput-5" placeholder="Enter password">
            <button id="togglePassword-5" onclick="togglePasswordVisibility(5)">Show</button>
            <button onclick="submitPassword(5)">Upload PDF</button>
            <div class="link-container"></div>
        </div>

        <button class="storage-button" onclick="openStoragePage()">Open Storage</button>
    </div>

    <!-- Storage Page -->
    <div id="storagePage">
        <h1>PDF Storage</h1>
        <div id="storagePdfContainer" class="pdf-container"></div>
    </div>

    <div id="pdfContainer" class="pdf-container hidden">
        <h2>Assignment Storage</h2>
    </div>
</body>
</html>
